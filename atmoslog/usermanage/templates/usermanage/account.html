{% extends "base.html" %}

{% block style %}
.settings{
	display: block;
	margin-top: 7px;
	margin-bottom: 0px;
}
.projectlisting{
	display: block;
}
{% endblock %}

{% block script %}
$(document).ready(function(){
	//Script to run the search projects function
	var projects_loaded = new Array();
	{% for project in user_projects %}
		projects_loaded.splice(projects_loaded.length - 1, 0, '{{ project }}');
	{% endfor %}
	$('#myprojects_search').bind('keydown keyup keypress', function(event){
		var search = $("#myprojects_search").val();
		projects_loaded.forEach(function(entry){
			var re = new RegExp(search, "gi");
			if (entry.match(re)){
				$("#my_" + entry).show();
			} else{
				$("#my_" + entry).hide();
			}
		});
	});

});
{% endblock %}

{% block content %}
<div class="container">
	<!-- Modal -->
		<div class="modal fade" id="settings" tabindex="-1" role="dialog" aria-labelledby="settings" aria-hidden="true">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="createTableLabel">Settings</h4>
		      </div>
		      <div class="modal-body">
		      	<form method="post" action="/account/" role="form">
		      		<label for="aboutme">Edit about me</label>
		      		<textarea class="form-control" id="aboutme" name="aboutme" rows="4"></textarea>
		      	</br>
		      		<div class="form-group">
	                	<label for"programlang">Choose your favorite programming language</label>
		                <select class="form-control" id="programlang" name="programlang" title="programlang">
		                		<option value="?">Undecided</option>
		                		<option value="py">Python</option>
		                		<option value="c++">C++</option>
		                		<option value="java">Java</option>
		                		<option value="php">PHP</option>
		                		<option value="ruby">Ruby</option>
		                		<option value="obj-c">Objective-C</option>
		                		<option value="c">C</option>
		                		<option value="vb">Visual Basic</option>
		                		<option value="javasc">Javascript</option>
		                		<option value="perl">Perl</option>
		                		<option value="assem">Assembly</option>
		                		<option value="r">R</option>
		                		<option value="swift">Swift</option>
		                		<option value="pascal">Pascal</option>
		                		<option value="scala">Scala</option>
		                		<option value="go">Go</option>
		                </select>
	           		</div>

	           		<div class="form-group">
	                	<label for"country">Country</label>
		                <select class="form-control" id="country" name="country" title="country">
		                		<option value="afghanistan">Afghanistan</option>
		                		<option value="albania">Albania</option>
		                </select>
	           		</div>

		      		<div class="checkbox">
                    	<label><input id="showemail" name="showemail[]" value="yes" type="checkbox">Display email publicly</label>
                	</div>
					<div class="text-center">
		     			<button type="submit" value="login" class="btn btn-primary">Update</button>
		     		</div>
		     		<input type="hidden" name="formtype" value="settings" />
		     	</form>
		      </div>
		    </div>
		  </div>
		</div>
	<div class="row">
		<div class='col-md-2'>
			<div class="text-center">
				<img src = "{{ profile_picture }}" alt="Profile image" class="img-rounded">
				<a class="settings" href="http://en.gravatar.com/site/signup" target="_blank">Edit profile picture</a>
				<a class="settings" href="/changepassword/">Change password</a>
				<a class="settings" href="#">Change email</a>
				<a class="settings" data-toggle="modal" data-target="#settings" role="button">Settings</a>
			</div>
		</div>

		<div class='col-md-10'>
			<div class="well">
				<form method="post" action="/search/" role="form">
					{% csrf_token %}
					<div class="input-group">
				      <input type="text" class="form-control" name="query" aria-label="userproject_search" placeholder="Search projects or users">
				      <div class="input-group-btn">
				        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Search users <span class="caret"></span></button>
				        <ul class="dropdown-menu" role="menu">
				          <li><a href="#">Search projects</a></li>
				        </ul>
				        <button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
				      </div><!-- /btn-group -->
				    </div><!-- /input-group -->	
				</form>

			    {% if not firstname or not lastname %}
			    	<h1 class="text-center">{{ user}}</h1>
			    {% else %}
			    	<h1 class="text-center">{{ firstname }} "{{ user }}" {{ lastname }}</h1>
			    {% endif %}

			    <p><strong>Email: </strong>{{ email }}</p>
			   	<p><strong>About me: </strong>{{ about_me }}</p>
			   	<p><strong>Favorite programming language: </strong>{{ favorite_language }}</p>
			   	<p><strong>Joined on: </strong>{{ join_date }}</p>

			   	</br>
			   	<div class="text-center">
				   	<h4>My Projects:</h4>
				   	<form class="form-inline">
					  <div class="form-group">
					    <label for="myprojects_search" class="sr-only">Search my projects</label>
					    <input type="text" class="form-control" id="myprojects_search" placeholder="Search my projects">
					  </div>
					</form>
				</br>
					{% for project in user_projects %}
						<a class="projectlisting" href="/log/{{ project }}" id="my_{{ project }}">{{ project }}</a>
					{% endfor %}
				</div>
			</div> <!-- well -->
		</div> <!-- column -->
	</div> <!-- container -->
</div>
{% endblock %}